#pragma once
#include <array>
#include <cstdint>
#include <string_view>

#include "XRechnung.hpp"

namespace XRechnungUtils {
    // https://www.xrepository.de/details/urn:xoev-de:kosit:codeliste:untdid.7161_3
    enum class ChargeReasonCode : uint16_t {
        Advertising,
        Telecommunication,
        Technical_Modification,
        Job_Order_Production,
        Outlays,
        Off_Premises,
        Additional_Processing,
        Attesting,
        Acceptance,
        Rush_Delivery,
        Special_Construction,
        Airport_Facilities,
        Concession,
        Compulsory_Storage,
        Fuel_Removal,
        Into_Plane,
        Overtime,
        Tooling,
        Miscellaneous,
        Additional_Packaging,
        Dunnage,
        Containerisation,
        Carton_Packing,
        Hessian_Wrapped,
        Polyethylene_Wrap_Packing,
        Miscellaneous_Treatment,
        Enamelling_Treatment,
        Heat_Treatment,
        Plating_Treatment,
        Painting,
        Polishing,
        Priming,
        Preservation_Treatment,
        Fitting,
        Consolidation,
        Bill_Of_Lading,
        Airbag,
        Transfer,
        Slipsheet,
        Binding,
        Repair_Or_Replacement_Of_Broken_Returnable_Package,
        Efficient_Logistics,
        Merchandising,
        Product_Mix,
        Other_Services,
        Pick_Up,
        Chronic_Illness,
        New_Product_Introduction,
        Direct_Delivery,
        Diversion,
        Disconnect,
        Distribution,
        Handling_Of_Hazardous_Cargo,
        Rents_And_Leases,
        Location_Differential,
        Aircraft_Refueling,
        Fuel_Shipped_Into_Storage,
        Cash_On_Delivery,
        Small_Order_Processing_Service,
        Clerical_Or_Administrative_Services,
        Guarantee,
        Collection_And_Recycling,
        Copyright_Fee_Collection,
        Veterinary_Inspection_Service,
        Pensioner_Service,
        Medicine_Free_Pass_Holder,
        Environmental_Protection_Service,
        Environmental_Clean_Up_Service,
        National_Cheque_Processing_Service_Outside_Account_Area,
        National_Payment_Service_Outside_Account_Area,
        National_Payment_Service_Within_Account_Area,
        Adjustments,
        Authentication,
        Cataloguing,
        Cartage,
        Certification,
        Certificate_Of_Conformance,
        Certificate_Of_Origin,
        Cutting,
        Consular_Service,
        Customer_Collection,
        Payroll_Payment_Service,
        Cash_Transportation,
        Home_Banking_Service,
        Bilateral_Agreement_Service,
        Insurance_Brokerage_Service,
        Cheque_Generation,
        Preferential_Merchandising_Location,
        Crane,
        Special_Colour_Service,
        Sorting,
        Battery_Collection_And_Recycling,
        Product_Take_Back_Fee,
        Quality_Control_Released,
        Quality_Control_Held,
        Quality_Control_Embargo,
        Car_Loading,
        Cleaning,
        Cigarette_Stamping,
        Count_And_Recount,
        Layout_Design,
        Assortment_Allowance,
        Driver_Assigned_Unloading,
        Debtor_Bound,
        Dealer_Allowance,
        Allowance_Transferable_To_The_Consumer,
        Growth_Of_Business,
        Introduction_Allowance,
        Multi_Buy_Promotion,
        Partnership,
        Return_Handling,
        Minimum_Order_Not_Fulfilled_Charge,
        Point_Of_Sales_Threshold_Allowance,
        Wholesaling_Discount,
        Documentary_Credits_Transfer_Commission,
        Delivery,
        Engraving,
        Expediting,
        Exchange_Rate_Guarantee,
        Fabrication,
        Freight_Equalization,
        Freight_Extraordinary_Handling,
        Freight_Service,
        Filling_Handling,
        Financing,
        Grinding,
        Hose,
        Handling,
        Hoisting_And_Hauling,
        Installation,
        Installation_And_Warranty,
        Inside_Delivery,
        Inspection,
        Installation_And_Training,
        Invoicing,
        Koshering,
        Carrier_Count,
        Labelling,
        Labour,
        Repair_And_Return,
        Legalisation,
        Mounting,
        Mail_Invoice,
        Mail_Invoice_To_Each_Location,
        Non_Returnable_Containers,
        Outside_Cable_Connectors,
        Invoice_With_Shipment,
        Phosphatizing_Steel_Treatment,
        Packing,
        Palletizing,
        Repacking,
        Repair,
        Returnable_Container,
        Restocking,
        Re_Delivery,
        Refurbishing,
        Rail_Wagon_Hire,
        Loading,
        Salvaging,
        Shipping_And_Handling,
        Special_Packaging,
        Stamping,
        Consignee_Unload,
        Shrink_Wrap,
        Special_Handling,
        Special_Finish,
        Set_Up,
        Tank_Renting,
        Testing,
        Transportation_Third_Party_Billing,
        Transportation_By_Vendor,
        Drop_Yard,
        Drop_Dock,
        Warehousing,
        Combine_All_Same_Day_Shipment,
        Split_Pick_Up,
        Mutually_Defined
    };

    static constexpr std::array<std::u8string_view, 177> ChargeReasonCodes{
            u8"AA",
            u8"AAA",
            u8"AAC",
            u8"AAD",
            u8"AAE",
            u8"AAF",
            u8"AAH",
            u8"AAI",
            u8"AAS",
            u8"AAT",
            u8"AAV",
            u8"AAY",
            u8"AAZ",
            u8"ABA",
            u8"ABB",
            u8"ABC",
            u8"ABD",
            u8"ABF",
            u8"ABK",
            u8"ABL",
            u8"ABN",
            u8"ABR",
            u8"ABS",
            u8"ABT",
            u8"ABU",
            u8"ACF",
            u8"ACG",
            u8"ACH",
            u8"ACI",
            u8"ACJ",
            u8"ACK",
            u8"ACL",
            u8"ACM",
            u8"ACS",
            u8"ADC",
            u8"ADE",
            u8"ADJ",
            u8"ADK",
            u8"ADL",
            u8"ADM",
            u8"ADN",
            u8"ADO",
            u8"ADP",
            u8"ADQ",
            u8"ADR",
            u8"ADT",
            u8"ADW",
            u8"ADY",
            u8"ADZ",
            u8"AEA",
            u8"AEB",
            u8"AEC",
            u8"AED",
            u8"AEF",
            u8"AEH",
            u8"AEI",
            u8"AEJ",
            u8"AEK",
            u8"AEL",
            u8"AEM",
            u8"AEN",
            u8"AEO",
            u8"AEP",
            u8"AES",
            u8"AET",
            u8"AEU",
            u8"AEV",
            u8"AEW",
            u8"AEX",
            u8"AEY",
            u8"AEZ",
            u8"AJ",
            u8"AU",
            u8"CA",
            u8"CAB",
            u8"CAD",
            u8"CAE",
            u8"CAF",
            u8"CAI",
            u8"CAJ",
            u8"CAK",
            u8"CAL",
            u8"CAM",
            u8"CAN",
            u8"CAO",
            u8"CAP",
            u8"CAQ",
            u8"CAR",
            u8"CAS",
            u8"CAT",
            u8"CAU",
            u8"CAV",
            u8"CAW",
            u8"CAX",
            u8"CAY",
            u8"CAZ",
            u8"CD",
            u8"CG",
            u8"CS",
            u8"CT",
            u8"DAB",
            u8"DAC",
            u8"DAD",
            u8"DAF",
            u8"DAG",
            u8"DAH",
            u8"DAI",
            u8"DAJ",
            u8"DAK",
            u8"DAL",
            u8"DAM",
            u8"DAN",
            u8"DAO",
            u8"DAP",
            u8"DAQ",
            u8"DL",
            u8"EG",
            u8"EP",
            u8"ER",
            u8"FAA",
            u8"FAB",
            u8"FAC",
            u8"FC",
            u8"FH",
            u8"FI",
            u8"GAA",
            u8"HAA",
            u8"HD",
            u8"HH",
            u8"IAA",
            u8"IAB",
            u8"ID",
            u8"IF",
            u8"IR",
            u8"IS",
            u8"KO",
            u8"L1",
            u8"LA",
            u8"LAA",
            u8"LAB",
            u8"LF",
            u8"MAE",
            u8"MI",
            u8"ML",
            u8"NAA",
            u8"OA",
            u8"PA",
            u8"PAA",
            u8"PC",
            u8"PL",
            u8"RAB",
            u8"RAC",
            u8"RAD",
            u8"RAF",
            u8"RE",
            u8"RF",
            u8"RH",
            u8"RV",
            u8"SA",
            u8"SAA",
            u8"SAD",
            u8"SAE",
            u8"SAI",
            u8"SG",
            u8"SH",
            u8"SM",
            u8"SU",
            u8"TAB",
            u8"TAC",
            u8"TT",
            u8"TV",
            u8"V1",
            u8"V2",
            u8"WH",
            u8"XAA",
            u8"YY",
            u8"ZZZ"};

    inline std::u8string getChargeReasonCode(const ChargeReasonCode &code) {
        if (const auto idx = static_cast<size_t>(code); idx < ChargeReasonCodes.size())
            return ChargeReasonCodes.at(idx).data();
        return u8"";
    }
}// namespace XRechnungUtils
